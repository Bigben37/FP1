(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     17378,        437]
NotebookOptionsPosition[     16682,        409]
NotebookOutlinePosition[     17019,        424]
CellTagsIndexPosition[     16976,        421]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"matr", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<matrix\>\""}], ",", 
     "\"\<Table\>\"", ",", 
     RowBox[{"NumberPoint", "\[Rule]", "\"\<,\>\""}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{"matr", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{3.623153568689674*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.002223462`", 
      RowBox[{"-", "0.039761786`"}], "0.038596482`", 
      RowBox[{"-", "0.057150539`"}], "0.104904983`", 
      RowBox[{"-", "0.048841224`"}]},
     {
      RowBox[{"-", "0.039761786`"}], "0.713627443`", 
      RowBox[{"-", "0.693021642`"}], "1.050624836`", 
      RowBox[{"-", "1.931983155`"}], "0.901047084`"},
     {"0.038596482`", 
      RowBox[{"-", "0.693021642`"}], "0.673047757`", 
      RowBox[{"-", "1.023299883`"}], "1.882148471`", 
      RowBox[{"-", "0.877990861`"}]},
     {
      RowBox[{"-", "0.057150539`"}], "1.050624836`", 
      RowBox[{"-", "1.023299883`"}], "1.805980893`", 
      RowBox[{"-", "3.35831368`"}], "1.583127006`"},
     {"0.104904983`", 
      RowBox[{"-", "1.931983155`"}], "1.882148471`", 
      RowBox[{"-", "3.35831368`"}], "6.249787823`", 
      RowBox[{"-", "2.948350916`"}]},
     {
      RowBox[{"-", "0.048841224`"}], "0.901047084`", 
      RowBox[{"-", "0.877990861`"}], "1.583127006`", 
      RowBox[{"-", "2.948350916`"}], "1.391862893`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.623153569843083*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"temps", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"23", ",", "19", ",", "14", ",", "7", ",", "5", ",", "0", ",", 
    RowBox[{"-", "1"}], ",", 
    RowBox[{"-", "3"}], ",", 
    RowBox[{"-", "4"}], ",", 
    RowBox[{"-", "7"}], ",", 
    RowBox[{"-", "8"}], ",", "3", ",", "10"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tc", " ", "=", " ", "1764"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pc", " ", "=", " ", "167000000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TR", "[", "T_", "]"}], ":=", 
  RowBox[{"1", "-", 
   FractionBox["T", "Tc"]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"func", "[", "params_", "]"}], ":=", 
  RowBox[{"1000", "*", "pc", " ", 
   RowBox[{"Exp", "[", 
    RowBox[{
     FractionBox["Tc", "T"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a1", " ", 
        RowBox[{"TR", "[", "T", "]"}]}], "+", 
       RowBox[{"a2", " ", 
        SuperscriptBox[
         RowBox[{"TR", "[", "T", "]"}], "1.89"]}], "+", 
       RowBox[{"a3", " ", 
        SuperscriptBox[
         RowBox[{"TR", "[", "T", "]"}], "2"]}], "+", 
       RowBox[{"a4", " ", 
        SuperscriptBox[
         RowBox[{"TR", "[", "T", "]"}], "8"]}], "+", 
       RowBox[{"a5", " ", 
        SuperscriptBox[
         RowBox[{"TR", "[", "T", "]"}], "8.5"]}], "+", 
       RowBox[{"a6", " ", 
        SuperscriptBox[
         RowBox[{"TR", "[", "T", "]"}], "9"]}]}], ")"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"params", ":=", 
   RowBox[{"{", 
    RowBox[{
    "T", ",", "a1", ",", "a2", ",", "a3", ",", "a4", ",", "a5", ",", "a6"}], 
    "}"}]}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"values", ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "+", "273.15"}], "&"}], "/@", "temps"}], ",", 
     RowBox[{"-", "4.57618368"}], ",", 
     RowBox[{"-", "1.40726277"}], ",", "2.36263541", ",", 
     RowBox[{"-", "31.0889985"}], ",", "58.0183959", ",", 
     RowBox[{"-", "27.6304546"}]}], "}"}]}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cov", ":=", 
   RowBox[{"(", GridBox[{
      {
       SuperscriptBox["2", "2"], "0", "0", "0", "0", "0", "0"},
      {"0", "0.002223462`", 
       RowBox[{"-", "0.039761786`"}], "0.038596482`", 
       RowBox[{"-", "0.057150539`"}], "0.104904983`", 
       RowBox[{"-", "0.048841224`"}]},
      {"0", 
       RowBox[{"-", "0.039761786`"}], "0.713627443`", 
       RowBox[{"-", "0.693021642`"}], "1.050624836`", 
       RowBox[{"-", "1.931983155`"}], "0.901047084`"},
      {"0", "0.038596482`", 
       RowBox[{"-", "0.693021642`"}], "0.673047757`", 
       RowBox[{"-", "1.023299883`"}], "1.882148471`", 
       RowBox[{"-", "0.877990861`"}]},
      {"0", 
       RowBox[{"-", "0.057150539`"}], "1.050624836`", 
       RowBox[{"-", "1.023299883`"}], "1.805980893`", 
       RowBox[{"-", "3.35831368`"}], "1.583127006`"},
      {"0", "0.104904983`", 
       RowBox[{"-", "1.931983155`"}], "1.882148471`", 
       RowBox[{"-", "3.35831368`"}], "6.249787823`", 
       RowBox[{"-", "2.948350916`"}]},
      {"0", 
       RowBox[{"-", "0.048841224`"}], "0.901047084`", 
       RowBox[{"-", "0.877990861`"}], "1.583127006`", 
       RowBox[{"-", "2.948350916`"}], "1.391862893`"}
     }], ")"}]}], "  ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", ":=", 
   RowBox[{"Length", "[", "params", "]"}]}], "  ", 
  RowBox[{"(*", 
   RowBox[{"number", " ", "of", " ", "params"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covVars", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ToExpression", "[", 
      RowBox[{"\"\<cov\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"params", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"params", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "]"}]}], " ", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{"variables", " ", "for", " ", "cov", " ", "entries"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RepList", ":=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"params", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
        RowBox[{"values", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"covVars", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], "\[Rule]", 
         RowBox[{"cov", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", " ", "j"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}], "]"}]}],
     "]"}]}], "  ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "replacement", " ", "list", " ", "for", " ", "params", " ", "and", " ", 
     "cov"}], "-", "entries"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", "=", 
   RowBox[{
    RowBox[{"func", "[", "params", "]"}], "/.", "RepList"}]}], " ", 
  RowBox[{"(*", " ", "result", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"error", "=", 
   RowBox[{
    RowBox[{
     SqrtBox[
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"func", "[", "params", "]"}], ",", 
            RowBox[{"{", "params", "}"}]}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"func", "[", "params", "]"}], ",", 
            RowBox[{"{", "params", "}"}]}], "]"}], "[", 
          RowBox[{"[", "j", "]"}], "]"}], "*", 
         RowBox[{"covVars", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", " ", "j"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]], "/.", 
     "RepList"}], "  ", "//", "FullSimplify"}]}], 
  RowBox[{"(*", " ", "error", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  FractionBox[
   RowBox[{"100", "error"}], "res"], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6036980436875*^9, 3.6036983238125*^9}, {
   3.6036983551875*^9, 3.603698632390625*^9}, {3.60369867203125*^9, 
   3.60369867215625*^9}, {3.603698748671875*^9, 3.603698900390625*^9}, {
   3.603699034859375*^9, 3.60369941546875*^9}, {3.603702386296875*^9, 
   3.603702455671875*^9}, {3.6037026083125*^9, 3.603702613859375*^9}, {
   3.603703481328125*^9, 3.603703566828125*^9}, {3.60370360184375*^9, 
   3.60370367375*^9}, {3.60370373075*^9, 3.60370375440625*^9}, {
   3.60370389959375*^9, 3.603703958640625*^9}, {3.60468938290625*^9, 
   3.604689395046875*^9}, {3.60468959165625*^9, 3.604689710609375*^9}, {
   3.604689782*^9, 3.604689852046875*^9}, 3.60468994396875*^9, {
   3.60528525478125*^9, 3.605285348953125*^9}, {3.605285385046875*^9, 
   3.605285396*^9}, {3.605285428234375*^9, 3.605285439625*^9}, {
   3.605285578578125*^9, 3.6052857286875*^9}, {3.605285790234375*^9, 
   3.605285803140625*^9}, {3.605285851890625*^9, 3.60528585746875*^9}, {
   3.60528600078125*^9, 3.6052860223125*^9}, {3.605286245796875*^9, 
   3.60528638290625*^9}, 3.6052864865*^9, {3.605286531640625*^9, 
   3.605286575109375*^9}, {3.605286614296875*^9, 3.6052866146875*^9}, {
   3.605286697109375*^9, 3.605286702140625*^9}, {3.62023560525*^9, 
   3.620235678171875*^9}, {3.6231505223681593`*^9, 3.623150530563528*^9}, {
   3.623150568394504*^9, 3.623150582561946*^9}, {3.6231506221789103`*^9, 
   3.6231506240695667`*^9}, {3.623150855117189*^9, 3.6231508835239553`*^9}, {
   3.6231509192015657`*^9, 3.623150953433085*^9}, {3.6231509978278017`*^9, 
   3.6231510306507883`*^9}, {3.623151081171257*^9, 3.62315109884306*^9}, {
   3.6231511466598577`*^9, 3.6231511965620537`*^9}, {3.62315154638465*^9, 
   3.623151818788548*^9}, {3.623152048527631*^9, 3.623152065093124*^9}, {
   3.623152121930258*^9, 3.6231522185881557`*^9}, {3.623152263926364*^9, 
   3.6231524184270563`*^9}, {3.623152467838812*^9, 3.623152526367045*^9}, {
   3.623152603718649*^9, 3.6231526578832073`*^9}, {3.6231527755687723`*^9, 
   3.623152813012332*^9}, {3.623152855228199*^9, 3.623153173703383*^9}, {
   3.62315355346316*^9, 3.6231536991765623`*^9}, {3.62315375422162*^9, 
   3.6231537722530813`*^9}, {3.6231538525861797`*^9, 3.623153892245357*^9}, {
   3.623153966274763*^9, 3.623153978672387*^9}, {3.6231540157449093`*^9, 
   3.62315405639338*^9}, {3.623154115104711*^9, 3.623154134040983*^9}, {
   3.6231543496693172`*^9, 3.623154372176985*^9}, {3.6231544183368*^9, 
   3.6231544440996933`*^9}, {3.623154607417677*^9, 3.623154650400625*^9}, {
   3.623154695282535*^9, 3.6231547226759567`*^9}, {3.623154758690752*^9, 
   3.623154774739071*^9}, {3.623155048583922*^9, 3.623155071141159*^9}, {
   3.62315520891971*^9, 3.623155212647287*^9}, {3.62315535172959*^9, 
   3.623155360055355*^9}, {3.6231553912526217`*^9, 3.623155440177273*^9}, {
   3.623155532511835*^9, 3.623155538153651*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"23", ",", "19", ",", "14", ",", "7", ",", "5", ",", "0", ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "3"}], ",", 
   RowBox[{"-", "4"}], ",", 
   RowBox[{"-", "7"}], ",", 
   RowBox[{"-", "8"}], ",", "3", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{
  3.623152527094589*^9, 3.623152658808237*^9, 3.623153177690384*^9, 
   3.623153892953014*^9, 3.6231539861094437`*^9, {3.623154016150642*^9, 
   3.623154021491708*^9}, 3.623154057163294*^9, 3.623154136203951*^9, 
   3.623154373676729*^9, 3.623154445069379*^9, {3.623154621794979*^9, 
   3.623154651482562*^9}, {3.623154746157711*^9, 3.623154776297955*^9}, {
   3.623155054617097*^9, 3.6231550804985456`*^9}, {3.623155430983802*^9, 
   3.62315544059546*^9}, 3.6231555388298607`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "221.07081999752964`", ",", "157.10462768700967`", ",", 
   "101.12254342157539`", ",", "53.12487481205762`", ",", 
   "43.93375748220351`", ",", "26.98828746143451`", ",", 
   "24.428802215761667`", ",", "19.970044162974812`", ",", 
   "18.035231502319984`", ",", "13.222752604265997`", ",", 
   "11.904187927352671`", ",", "36.23129466344514`", ",", 
   "70.27907068915374`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.623152527094589*^9, 3.623152658808237*^9, 3.623153177690384*^9, 
   3.623153892953014*^9, 3.6231539861094437`*^9, {3.623154016150642*^9, 
   3.623154021491708*^9}, 3.623154057163294*^9, 3.623154136203951*^9, 
   3.623154373676729*^9, 3.623154445069379*^9, {3.623154621794979*^9, 
   3.623154651482562*^9}, {3.623154746157711*^9, 3.623154776297955*^9}, {
   3.623155054617097*^9, 3.6231550804985456`*^9}, {3.623155430983802*^9, 
   3.62315544059546*^9}, 3.623155538868209*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "37.23743917161133`", ",", "27.205245947499815`", ",", "18.1368336229426`", 
   ",", "10.018620528173324`", ",", "8.406880102763516`", ",", 
   "5.358298666220805`", ",", "4.886428284901607`", ",", "4.054892485531383`",
    ",", "3.689736988645037`", ",", "2.767504246501538`", ",", 
   "2.5106622123198665`", ",", "7.035451566592176`", ",", 
   "12.96968650973057`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.623152527094589*^9, 3.623152658808237*^9, 3.623153177690384*^9, 
   3.623153892953014*^9, 3.6231539861094437`*^9, {3.623154016150642*^9, 
   3.623154021491708*^9}, 3.623154057163294*^9, 3.623154136203951*^9, 
   3.623154373676729*^9, 3.623154445069379*^9, {3.623154621794979*^9, 
   3.623154651482562*^9}, {3.623154746157711*^9, 3.623154776297955*^9}, {
   3.623155054617097*^9, 3.6231550804985456`*^9}, {3.623155430983802*^9, 
   3.62315544059546*^9}, 3.623155538995222*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "16.844122246449096`", ",", "17.31664200350561`", ",", "17.93549984925809`",
    ",", "18.858624257688458`", ",", "19.135354189017267`", ",", 
   "19.854163306499757`", ",", "20.002733829286328`", ",", 
   "20.30487490382871`", ",", "20.45849529666643`", ",", "20.92986482715158`",
    ",", "21.09057944684349`", ",", "19.41816220464917`", ",", 
   "18.45455038399106`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.623152527094589*^9, 3.623152658808237*^9, 3.623153177690384*^9, 
   3.623153892953014*^9, 3.6231539861094437`*^9, {3.623154016150642*^9, 
   3.623154021491708*^9}, 3.623154057163294*^9, 3.623154136203951*^9, 
   3.623154373676729*^9, 3.623154445069379*^9, {3.623154621794979*^9, 
   3.623154651482562*^9}, {3.623154746157711*^9, 3.623154776297955*^9}, {
   3.623155054617097*^9, 3.6231550804985456`*^9}, {3.623155430983802*^9, 
   3.62315544059546*^9}, 3.6231555389986067`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"temps", ",", " ", "res", ",", " ", "error"}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.623155499654429*^9, 3.623155524145587*^9}, {
  3.6231555712443657`*^9, 3.6231555741173487`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
    "\"\<../calc/temp_pressure.txt\>\""}], ",", "data", ",", " ", 
   "\"\<Table\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.623155576421146*^9, 3.6231556396159277`*^9}}],

Cell[BoxData["\<\"/home/benjamin/Documents/Uni/FP1.git/1016-Hanle/stuff/../\
calc/temp_pressure.txt\"\>"], "Output",
 CellChangeTimes->{3.623155645156521*^9}]
}, Open  ]]
},
WindowSize->{1366, 719},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.0 for Linux x86 (64-bit) (September 9, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 383, 11, 55, "Input"],
Cell[965, 35, 1605, 40, 122, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2607, 80, 9663, 228, 727, "Input"],
Cell[12273, 310, 784, 15, 32, "Output"],
Cell[13060, 327, 939, 17, 32, "Output"],
Cell[14002, 346, 929, 16, 32, "Output"],
Cell[14934, 364, 934, 16, 32, "Output"]
}, Open  ]],
Cell[15883, 383, 310, 8, 32, "Input"],
Cell[CellGroupData[{
Cell[16218, 395, 287, 7, 32, "Input"],
Cell[16508, 404, 158, 2, 32, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
